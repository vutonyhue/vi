function a(){try{const e=document.createElement("script");e.src=chrome.runtime.getURL("inpage.js"),e.type="text/javascript",e.onload=()=>{e.remove(),console.log("[FUN Wallet] Inpage script loaded")},e.onerror=o=>{console.error("[FUN Wallet] Failed to load inpage script:",o)};const t=document.head||document.documentElement;t.insertBefore(e,t.firstChild)}catch(e){console.error("[FUN Wallet] Failed to inject provider:",e)}}window.addEventListener("message",async e=>{if(e.data.type!=="FUN_WALLET_REQUEST")return;const{id:t,method:o,params:s}=e.data;try{const r=await new Promise(n=>{chrome.runtime.sendMessage({type:o,payload:s,origin:window.location.origin,requestId:t},c=>{chrome.runtime.lastError?n({error:chrome.runtime.lastError.message}):n(c||{error:"No response from background"})})});r.success?window.postMessage({type:"FUN_WALLET_RESPONSE",id:t,result:r.data},"*"):r.error&&!r.error.includes("Pending user approval")&&window.postMessage({type:"FUN_WALLET_RESPONSE",id:t,error:r.error},"*")}catch(r){window.postMessage({type:"FUN_WALLET_RESPONSE",id:t,error:r.message},"*")}});chrome.runtime.onMessage.addListener((e,t,o)=>{if(e.type==="FUN_WALLET_RESPONSE"){window.postMessage({type:"FUN_WALLET_RESPONSE",id:e.requestId,result:e.result,error:e.error},"*");return}switch(e.type){case"chainChanged":window.postMessage({type:"FUN_WALLET_EVENT",event:"chainChanged",data:e.chainId},"*");break;case"accountsChanged":window.postMessage({type:"FUN_WALLET_EVENT",event:"accountsChanged",data:e.accounts},"*");break;case"disconnect":window.postMessage({type:"FUN_WALLET_EVENT",event:"disconnect",data:{code:4900,message:"Disconnected"}},"*");break;case"connect":window.postMessage({type:"FUN_WALLET_EVENT",event:"connect",data:{chainId:e.chainId}},"*");break}});document.readyState==="loading"?document.addEventListener("DOMContentLoaded",a):a();console.log("[FUN Wallet] Content script loaded");
