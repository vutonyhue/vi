const _={WALLETS:"fun_wallet_list",ACTIVE_WALLET:"fun_wallet_active",ENCRYPTED_KEYS:"fun_wallet_encrypted_v2",CURRENT_CHAIN:"fun_wallet_chain",PIN_HASH:"fun_wallet_pin_hash",SESSION_TOKEN:"fun_wallet_session",AUTO_LOCK_TIME:"fun_wallet_auto_lock",LAST_ACTIVITY:"fun_wallet_last_activity",SETTINGS:"fun_wallet_settings",THEME:"fun_wallet_theme",LANGUAGE:"fun_wallet_language",CUSTOM_TOKENS:"fun_wallet_custom_tokens",TOKEN_PRICES_CACHE:"fun_wallet_prices_cache",DAPP_CONNECTIONS:"fun_wallet_dapp_connections",PENDING_REQUESTS:"fun_wallet_pending_requests"},a={algorithm:"AES-GCM",keyLength:256,ivLength:12,saltLength:16,pbkdf2Iterations:1e5,hash:"SHA-256",version:1};function i(t){const e=new Uint8Array(t);let r="";for(let n=0;n<e.byteLength;n++)r+=String.fromCharCode(e[n]);return btoa(r)}function l(t){const e=atob(t),r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r.buffer}async function f(t,e){const r=new TextEncoder,n=await crypto.subtle.importKey("raw",r.encode(t),"PBKDF2",!1,["deriveBits","deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:e,iterations:a.pbkdf2Iterations,hash:a.hash},n,{name:a.algorithm,length:a.keyLength},!1,["encrypt","decrypt"])}async function y(t,e){if(!t||t.length<64)throw new Error("Invalid private key format");if(!e||e.length<6)throw new Error("Password must be at least 6 characters");const r=crypto.getRandomValues(new Uint8Array(a.saltLength)),n=crypto.getRandomValues(new Uint8Array(a.ivLength)),o=await f(e,r),c=new TextEncoder,s=await crypto.subtle.encrypt({name:a.algorithm,iv:n},o,c.encode(t));return{encryptedKey:i(s),iv:i(n.buffer),salt:i(r.buffer),version:a.version,createdAt:Date.now()}}async function h(t,e){if(!t||!e)throw new Error("Missing encrypted data or password");try{const r=new Uint8Array(l(t.salt)),n=new Uint8Array(l(t.iv)),o=l(t.encryptedKey),c=await f(e,r),s=await crypto.subtle.decrypt({name:a.algorithm,iv:n},c,o);return new TextDecoder().decode(s)}catch{throw new Error("Incorrect password or corrupted data")}}function d(t){let e=0;t.length>=8&&(e+=1),t.length>=12&&(e+=1),/[a-z]/.test(t)&&/[A-Z]/.test(t)&&(e+=1),/\d/.test(t)&&(e+=1),/[!@#$%^&*(),.?":{}|<>]/.test(t)&&(e+=1);const r=["Rất yếu","Yếu","Trung bình","Mạnh","Rất mạnh"],n=["destructive","warning","warning","success","success"];return{score:e,label:r[Math.min(e,4)],color:n[Math.min(e,4)]}}export{_ as S,h as d,y as e,d as g};
